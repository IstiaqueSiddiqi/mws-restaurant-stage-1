<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <!-- Manifest -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#333">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="description" content="Restaurant Reviews project for Mobile Web Specialist Nanodegree course by Udacity" />

  <link rel="icon" href="build/img/restaurant.png">
  <link rel="stylesheet" src="//normalize-css.googlecode.com/svn/trunk/normalize.css" inline/>
  <style>@charset "utf-8";body{background-color:#fdfdfd;position:relative}body,html{margin:0;padding:0}#maincontent,header,textarea{width:100%}.flex-container{display:flex;flex-wrap:wrap}body,li,p,td,ul{font-family:Arial,Helvetica,sans-serif;color:#333}body,p,td{line-height:1.5;font-size:13px}li,ul{font-size:10pt}a{color:orange;text-decoration:none}a:focus,a:hover{color:#3397db;text-decoration:none}a img{border:0 #fff}h1,h2,h3{font-family:Arial,Helvetica,sans-serif;margin:0 0 20px}aside,footer,header,menu,nav,section{display:block}#maincontent{background-color:#f3f3f3;min-height:100%}#footer,nav h1 a{text-transform:uppercase}#footer,nav{width:100%;text-align:center}#footer{padding:25px;color:#aaa;font-size:10px;letter-spacing:1px;background-color:#444}nav{height:80px;background-color:#252831;display:table}nav h1{margin:auto;display:table-cell;vertical-align:middle}nav h1 a{color:#fff;font-size:14pt;font-weight:200;letter-spacing:16px}#breadcrumb{padding:10px 40px 16px;list-style:none;background-color:#eee;font-size:17px;margin:0}#breadcrumb li{display:inline}#breadcrumb li+li:before{padding:8px;color:#000;content:"/\00a0"}#breadcrumb li a{color:#0275d8;text-decoration:none}#breadcrumb li a:hover{color:#01447e;text-decoration:underline}.skip-link{position:absolute;top:-40px;left:0;background:#333;color:#fff;padding:8px;z-index:100}.skip-link:focus{top:0}#map{height:400px;width:100%;background-color:#ccc}#restaurants-list,.filter-options,fieldset{display:flex;flex-wrap:wrap}.filter-options{width:100%;height:50px;align-items:center;background-color:#3397db}.filter-options h2{color:#fff;font-size:1rem;font-weight:400;line-height:1;margin:0 10px}#restaurants-list li,.filter-options select{background-color:#fff;font-family:Arial,sans-serif}.filter-options select{font-size:14px;height:35px;letter-spacing:0;width:25%;border:1px solid #fff;margin:10px;padding:0 10px}#restaurants-list{background-color:#f3f3f3;list-style:outside none none;margin:0;padding:16px;text-align:center}#restaurants-list li{border:2px solid #ccc;margin:0;min-height:380px;padding:16px;text-align:left}#restaurants-list .restaurant-img{background-color:#ccc;display:block;margin:0;min-height:248px;width:100%}#restaurant-name,#restaurants-list li h1{color:#f18200;font-family:Arial,sans-serif;letter-spacing:0;text-transform:uppercase}#restaurants-list li h1{width:100%;font-size:13pt;line-height:1.3;margin:20px 0 10px}#restaurants-list p{margin:0;font-size:14px;width:100%}#restaurants-list li a,#reviews-list li #bottom .rating span{background-color:orange;color:#fff;text-transform:uppercase;display:inline-block}#restaurants-list li a{border-bottom:3px solid #eee;font-size:13px;margin:15px 0 0;text-align:center;text-decoration:none;padding:8px 30px 10px}.inside header{width:100%;z-index:1000}.inside #map-container{background:#00f 0 0;height:400px;width:100%}.inside #map{background-color:#ccc;height:100%;width:100%}.inside #footer{max-width:100%}#restaurant-name{font-size:20pt;font-weight:200;margin:15px 0 30px;line-height:1.1}#restaurant-img,#reviews-list li{width:90%;border-top-left-radius:32px;border-bottom-right-radius:32px}#restaurant-address{font-size:12pt;margin:10px 0}#restaurant-cuisine{background-color:#333;color:#ddd;font-size:12pt;font-weight:300;letter-spacing:10px;margin:0 0 20px;padding:2px 0;text-align:center;text-transform:uppercase;width:90%}#restaurant-container,#reviews-container{border-bottom:1px solid #d9d9d9;border-top:1px solid #fff;max-width:100%}#reviews-container{padding:30px 40px 80px}#reviews-container h2{color:#f58500;font-size:24pt;font-weight:300;letter-spacing:-1px;padding-bottom:1pt}#reviews-list{margin:0;padding:0}#reviews-list li{background-color:#fff;border:2px solid #f3f3f3;display:block;list-style-type:none;margin:0 0 30px;overflow:hidden;position:relative;width:85%}#restaurant-hours td{color:#666}#reviews-list li #head{padding:0 24px 24px;background-color:#333;min-height:25px}#reviews-list li #head .alignLeft{float:left;color:#fff;font-weight:700;font-size:12pt}#reviews-list li #head .alignRight{float:right;color:rgba(255,255,255,.74);font-weight:600}#reviews-list li #bottom{padding:0 24px 24px}#reviews-list li #bottom .rating span{padding:8px;border-radius:5px;font-weight:700}#reviews-list li #bottom .rating{margin-top:16px}#review_form{margin-bottom:30px}form{width:85%;border:1px solid #eee}fieldset{border:0;background-color:#fff;padding:16px}.align-rating{float:left;width:40%}.align-name{float:right;width:40%}label{font-weight:700}#rating-select{height:35px;width:100%}#reviewer-name{height:30px;width:100%}#btn-review{width:auto;height:auto;padding:8px;background-color:orange;color:#fff;border:0;border-bottom:3px solid #eee}#btn-review:hover{box-shadow:0 4px 8px 0 rgba(0,0,0,.2)}@media only screen and (max-width:480px){.filter-options select{width:100%}.filter-options{height:auto}.filter-options h2{margin:16px}#restaurants-list li{margin:8px}}@media only screen and (min-width:481px) and (max-width:960px){#restaurants-list{justify-content:center}#restaurants-list li{width:38%;margin:8px}}@media only screen and (min-width:961px){#restaurants-list{width:1000px;margin-left:auto;margin-right:auto}#restaurants-list li{width:26.8%;margin:8px}.inside header{position:fixed;top:0}#breadcrumb{width:calc(50% - 80px)}.inside #map-container{background:#00f 0 0;height:87%;position:fixed;right:0;top:80px;width:50%}#restaurant-container,#reviews-container{border-bottom:1px solid #d9d9d9;border-top:1px solid #fff;padding:140px 40px 30px;width:calc(50% - 80px)}#footer{z-index:1000}}@media screen and (max-width:960px){nav h1 a{font-size:14px;letter-spacing:4px}#breadcrumb{padding-left:20px;padding-right:20px}#restaurant-cuisine,#restaurant-img,#reviews-list li,form{width:100%}#restaurant-container,#reviews-container{padding:24px}#restaurant-name{font-size:4vw}}</style>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ=="
    crossorigin="" inline/>
  <link rel="stylesheet" type="text/css" href="build/css/snackbar.css" inline />
  <title>Restaurant Reviews</title>
</head>

<body>
  <div class="flex-container">
    <header>
      <a href="#filter-content" class="skip-link" tabindex="0" aria-label="Skip map section to filter section">Skip map section to filter section</a>
      <nav>
        <h1>
          <a href="/">Restaurant Reviews</a>
        </h1>
      </nav>
    </header>
    <main id="maincontent">
      <section id="map-container">
        <div id="map" role="application" aria-label="Select nearby restaurants on map using tab key"></div>
      </section>
      <section>
        <div class="filter-options" id="filter-content" tabindex="-1">
          <h2>Filter Results</h2>
          <select id="neighborhoods-select" aria-label="Select neighborhoods" name="neighborhoods" onchange="updateRestaurants()">
            <option value="all">All Neighborhoods</option>
          </select>
          <select id="cuisines-select" aria-label="Select cuisines" name="cuisines" onchange="updateRestaurants()">
            <option value="all">All Cuisines</option>
          </select>
        </div>
        <ul id="restaurants-list"></ul>
      </section>
    </main>
    <footer id="footer">
      Copyright (c) 2017
      <a href="/" tabindex="0">
        <strong>Restaurant Reviews</strong>
      </a> All Rights Reserved.
    </footer>
  </div>
  <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js" integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw=="
    crossorigin=""></script>
  <script>"use strict";!function(){function u(n){return new Promise(function(e,t){n.onsuccess=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function i(n,o,r){var i,e=new Promise(function(e,t){u(i=n[o].apply(n,r)).then(e,t)});return e.request=i,e}function e(e,n,t){t.forEach(function(t){Object.defineProperty(e.prototype,t,{get:function(){return this[n][t]},set:function(e){this[n][t]=e}})})}function t(t,n,o,e){e.forEach(function(e){e in o.prototype&&(t.prototype[e]=function(){return i(this[n],e,arguments)})})}function n(t,n,o,e){e.forEach(function(e){e in o.prototype&&(t.prototype[e]=function(){return this[n][e].apply(this[n],arguments)})})}function o(e,o,t,n){n.forEach(function(n){n in t.prototype&&(e.prototype[n]=function(){return e=this[o],(t=i(e,n,arguments)).then(function(e){if(e)return new c(e,t.request)});var e,t})})}function r(e){this._index=e}function c(e,t){this._cursor=e,this._request=t}function s(e){this._store=e}function p(n){this._tx=n,this.complete=new Promise(function(e,t){n.oncomplete=function(){e()},n.onerror=function(){t(n.error)},n.onabort=function(){t(n.error)}})}function a(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new p(n)}function f(e){this._db=e}e(r,"_index",["name","keyPath","multiEntry","unique"]),t(r,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),o(r,"_index",IDBIndex,["openCursor","openKeyCursor"]),e(c,"_cursor",["direction","key","primaryKey","value"]),t(c,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(n){n in IDBCursor.prototype&&(c.prototype[n]=function(){var t=this,e=arguments;return Promise.resolve().then(function(){return t._cursor[n].apply(t._cursor,e),u(t._request).then(function(e){if(e)return new c(e,t._request)})})})}),s.prototype.createIndex=function(){return new r(this._store.createIndex.apply(this._store,arguments))},s.prototype.index=function(){return new r(this._store.index.apply(this._store,arguments))},e(s,"_store",["name","keyPath","indexNames","autoIncrement"]),t(s,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),o(s,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),n(s,"_store",IDBObjectStore,["deleteIndex"]),p.prototype.objectStore=function(){return new s(this._tx.objectStore.apply(this._tx,arguments))},e(p,"_tx",["objectStoreNames","mode"]),n(p,"_tx",IDBTransaction,["abort"]),a.prototype.createObjectStore=function(){return new s(this._db.createObjectStore.apply(this._db,arguments))},e(a,"_db",["name","version","objectStoreNames"]),n(a,"_db",IDBDatabase,["deleteObjectStore","close"]),f.prototype.transaction=function(){return new p(this._db.transaction.apply(this._db,arguments))},e(f,"_db",["name","version","objectStoreNames"]),n(f,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(i){[s,r].forEach(function(e){i in e.prototype&&(e.prototype[i.replace("open","iterate")]=function(){var e,t=(e=arguments,Array.prototype.slice.call(e)),n=t[t.length-1],o=this._store||this._index,r=o[i].apply(o,t.slice(0,-1));r.onsuccess=function(){n(r.result)}})})}),[r,s].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,n){var o=this,r=[];return new Promise(function(t){o.iterateCursor(e,function(e){e?(r.push(e.value),void 0===n||r.length!=n?e.continue():t(r)):t(r)})})})});var d={open:function(e,t,n){var o=i(indexedDB,"open",[e,t]),r=o.request;return r&&(r.onupgradeneeded=function(e){n&&n(new a(r.result,e.oldVersion,r.transaction))}),o.then(function(e){return new f(e)})},delete:function(e){return i(indexedDB,"deleteDatabase",[e])}};"undefined"!=typeof module?(module.exports=d,module.exports.default=module.exports):self.idb=d}();</script>
  <script charset="utf-8">"use strict";var _createClass=function(){function r(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,n,t){return n&&r(e.prototype,n),t&&r(e,t),e}}();function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var DBHelper=function(){function u(){_classCallCheck(this,u)}return _createClass(u,null,[{key:"openDB",value:function(){return"indexedDB"in window?idb.open("Restaurants Reviews",1,function(e){e.objectStoreNames.contains(u.RESTAURANT_STORE)||(e.createObjectStore(u.RESTAURANT_STORE,{keyPath:"id"}).createIndex("id","id"),e.createObjectStore(u.REVIEW_STORE,{keyPath:"id"}).createIndex("id","id"),e.createObjectStore(u.OFFLINE_STORE,{keyPath:"createdAt"}).createIndex("restaurant_id","restaurant_id"))}):null}},{key:"fetchRestaurants",value:function(n){u.getAllRestaurants().then(function(e){n(null,e),u.saveRestaurantLocally(e).then(function(e){console.log("Fetched all restaurants data from server")}).catch(function(e){console.error("Failed to save restaurants locally: "+e.stack)})}).catch(function(e){console.log("Unable to fetch restaurants from server: "+e.stack),u.getSavedRestaurantData().then(function(e){n(null,e)})})}},{key:"getAllRestaurants",value:function(){return new Promise(function(n,t){u.getServerData(u.DATABASE_URL+"/restaurants").then(function(e){return n(e)}).catch(function(e){return t(e)})})}},{key:"getRestaurantById",value:function(e){return new Promise(function(n,t){u.getServerData(u.DATABASE_URL+"/restaurants/"+e).then(function(e){return n(e)}).catch(function(e){return t(e)})})}},{key:"getRestaurantReviewById",value:function(e){return new Promise(function(n,t){u.getServerData(u.DATABASE_URL+"/reviews/?restaurant_id="+e).then(function(e){return n(e)}).catch(function(e){return t(e)})})}},{key:"addReview",value:function(r){return new Promise(function(t,n){u.mutateData(u.DATABASE_URL+"/reviews/","POST",r).then(function(n){console.info("Successfully submitted review"),u.saveRestaurantReviews(n,u.REVIEW_STORE).then(function(e){return console.info("Review saved for offline use"),t(n)}).catch(function(e){return console.error("Failed to save review: "+e.stack),t(n)})}).catch(function(e){console.info("No internet, failed to upload review: "+e.stack),u.saveRestaurantReviews(r,u.OFFLINE_STORE).then(function(e){return console.log("Review will be uploaded automatically when connected to internet"),Snackbar.show({text:"Not connected, Review will be uploaded once re-connected!",actionText:"OK",textColor:"#fff",actionTextColor:"#f44336",pos:"bottom-center"}),t(r)}).catch(function(e){return console.error("Failed to save review: "+e.stack),n(e)})})})}},{key:"mutateData",value:function(e,r,o){return new Promise(function(n,t){fetch(e,{method:r,body:JSON.stringify(o),headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){return n(e)}).catch(function(e){return console.log("1",e.stack),t(e)})})}},{key:"fetchRestaurantReviews",value:function(n,t){u.getRestaurantReviewById(n.id).then(function(e){t(null,e),u.saveRestaurantReviews(e,u.REVIEW_STORE).then(function(e){console.log("Review from Server")}).catch(function(e){console.error("Failed to save review locally: "+e.stack)})}).catch(function(e){console.log("Unable to fetch review from server: "+e.stack),Snackbar.show({text:"You lost connection.",actionText:"OK",actionTextColor:"#f44336",textColor:"#fff",pos:"bottom-center"}),u.getSavedReview(n.id).then(function(e){t(null,e)})})}},{key:"getSavedReview",value:function(t){return new Promise(function(e,n){return"indexedDB"in window?e(t?u.openDB().then(function(e){return e.transaction(u.REVIEW_STORE,"readonly").objectStore(u.REVIEW_STORE).get(t)}):u.openDB().then(function(e){return e.transaction(u.REVIEW_STORE,"readonly").objectStore(u.REVIEW_STORE).getAll()})):n(null)})}},{key:"getServerData",value:function(e){return new Promise(function(n,t){fetch(e,{mode:"cors"}).then(function(e){return e.ok?n(e.json()):t(Error(e.statusText))}).catch(function(e){return console.log("Request failed",e.stack),t(e)})})}},{key:"saveRestaurantLocally",value:function(r){if(!Array.isArray(r)){var e=[];e.push(r),r=e}return new Promise(function(e,n){return"indexedDB"in window?e(u.openDB().then(function(e){var n=e.transaction(u.RESTAURANT_STORE,"readwrite"),t=n.objectStore(u.RESTAURANT_STORE);return Promise.all(r.map(function(e){return t.put(e)})).catch(function(){throw n.abort(),Error("Restaurants were not added to the store")}).then(function(){console.log("Restaurants added to DB")})})):n(null)})}},{key:"saveRestaurantReviews",value:function(r,o){if(!Array.isArray(r)){var e=[];e.push(r),r=e}return new Promise(function(e,n){return"indexedDB"in window?e(u.openDB().then(function(e){var n=e.transaction(o,"readwrite"),t=n.objectStore(o);return Promise.all(r.map(function(e){return t.put(e)})).catch(function(){throw n.abort(),Error("Reviews were not added to the "+o)}).then(function(){console.log("Reviews added to DB")})})):n(null)})}},{key:"getSavedRestaurantData",value:function(t){return new Promise(function(e,n){return"indexedDB"in window?e(t?u.openDB().then(function(e){return e.transaction(u.RESTAURANT_STORE,"readonly").objectStore(u.RESTAURANT_STORE).get(t)}):u.openDB().then(function(e){return e.transaction(u.RESTAURANT_STORE,"readonly").objectStore(u.RESTAURANT_STORE).getAll()})):n(null)})}},{key:"fetchRestaurantById",value:function(r,o){u.fetchRestaurants(function(e,n){if(e)o(e,null);else{var t=n.find(function(e){return e.id==r});t?o(null,t):o("Restaurant does not exist",null)}})}},{key:"fetchRestaurantByCuisine",value:function(r,o){u.fetchRestaurants(function(e,n){if(e)o(e,null);else{var t=n.filter(function(e){return e.cuisine_type==r});o(null,t)}})}},{key:"fetchRestaurantByNeighborhood",value:function(r,o){u.fetchRestaurants(function(e,n){if(e)o(e,null);else{var t=n.filter(function(e){return e.neighborhood==r});o(null,t)}})}},{key:"fetchRestaurantByCuisineAndNeighborhood",value:function(r,o,a){u.fetchRestaurants(function(e,n){if(e)a(e,null);else{var t=n;"all"!=r&&(t=t.filter(function(e){return e.cuisine_type==r})),"all"!=o&&(t=t.filter(function(e){return e.neighborhood==o})),a(null,t)}})}},{key:"fetchNeighborhoods",value:function(o){u.fetchRestaurants(function(e,t){if(e)o(e,null);else{var r=t.map(function(e,n){return t[n].neighborhood}),n=r.filter(function(e,n){return r.indexOf(e)==n});o(null,n)}})}},{key:"fetchCuisines",value:function(o){u.fetchRestaurants(function(e,t){if(e)o(e,null);else{var r=t.map(function(e,n){return t[n].cuisine_type}),n=r.filter(function(e,n){return r.indexOf(e)==n});o(null,n)}})}},{key:"urlForRestaurant",value:function(e){return"./restaurant.html?id="+e.id}},{key:"imageUrlForRestaurant",value:function(e){return e.id}},{key:"mapMarkerForRestaurant",value:function(e,n){var t=new L.marker([e.latlng.lat,e.latlng.lng],{title:e.name,alt:e.name,url:u.urlForRestaurant(e)});return t.addTo(newMap),t}},{key:"syncOutBoxData",value:function(){return new Promise(function(e,n){return"indexedDB"in window?e(u.openDB().then(function(e){return e.transaction(u.OFFLINE_STORE,"readonly").objectStore(u.OFFLINE_STORE).getAll()})):n(null)})}},{key:"clearOutBoxData",value:function(t){return new Promise(function(e,n){return"indexedDB"in window?e(u.openDB().then(function(e){return e.transaction(u.OFFLINE_STORE,"readwrite").objectStore(u.OFFLINE_STORE).delete(t)})):n(null)})}},{key:"RESTAURANT_STORE",get:function(){return"Restaurants"}},{key:"REVIEW_STORE",get:function(){return"Reviews"}},{key:"OFFLINE_STORE",get:function(){return"Outbox"}},{key:"DATABASE_URL",get:function(){return"http://localhost:1337"}}]),u}();</script>
  <script charset="utf-8">"use strict";function _asyncToGenerator(e){return function(){var s=e.apply(this,arguments);return new Promise(function(a,i){return function t(e,n){try{var r=s[e](n),o=r.value}catch(e){return void i(e)}if(!r.done)return Promise.resolve(o).then(function(e){t("next",e)},function(e){t("throw",e)});a(o)}("next")})}}var newMap,restaurants=void 0,neighborhoods=void 0,cuisines=void 0,markers=[],MAPBOX_API_KEY="pk.eyJ1IjoiaXN0aWFxdWUxOCIsImEiOiJjampjbzhxYnEyM3ZlM3Z0ZWRncHVsOXEyIn0.G92w014uYkp64EiGScJH8Q",registerServiceWorker=function(){(navigator.serviceWorker||window.SyncManager)&&(navigator.serviceWorker.register("/sw.js").then(function(e){console.log("Service worker registered.. "+JSON.stringify(e)),navigator.serviceWorker.controller&&(e.waiting?updateReady(e.waiting):e.installing?trackInstalling(e.installing):e.addEventListener("updatefound",function(){trackInstalling(e.installing)}))}).catch(function(e){console.error("Error while registering service worker "+e)}),navigator.serviceWorker.addEventListener("controllerchange",function(){window.location.reload()}),navigator.serviceWorker.ready.then(function(e){return e.sync.register("myFirstSync")}))},trackInstalling=function(e){e.addEventListener("statechange",function(){"installed"==e.state&&(void 0).updateReady(e)})},updateReady=function(e){e.postMessage({action:"skipWaiting"})};document.addEventListener("DOMContentLoaded",function(e){registerServiceWorker(),initMap(),fetchNeighborhoods(),fetchCuisines()});var fetchNeighborhoods=function(){DBHelper.fetchNeighborhoods(function(e,t){e?console.error(e):(self.neighborhoods=t,fillNeighborhoodsHTML())})},fillNeighborhoodsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.neighborhoods,n=document.getElementById("neighborhoods-select");e.forEach(function(e){var t=document.createElement("option");t.innerHTML=e,t.value=e,n.append(t)})},fetchCuisines=function(){DBHelper.fetchCuisines(function(e,t){e?console.error(e):(self.cuisines=t,fillCuisinesHTML())})},fillCuisinesHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.cuisines,n=document.getElementById("cuisines-select");e.forEach(function(e){var t=document.createElement("option");t.innerHTML=e,t.value=e,n.append(t)})},initMap=function(){self.newMap=L.map("map",{center:[40.722216,-73.987501],zoom:12,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:MAPBOX_API_KEY,maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox.streets"}).addTo(newMap),updateRestaurants()},updateRestaurants=function(){var e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),n=e.selectedIndex,r=t.selectedIndex,o=e[n].value,a=t[r].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(o,a,function(e,t){e?console.error(e):(resetRestaurants(t),fillRestaurantsHTML())})},resetRestaurants=function(e){self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",self.markers&&self.markers.forEach(function(e){return e.remove()}),self.markers=[],self.restaurants=e},fillRestaurantsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurants,t=document.getElementById("restaurants-list");e.forEach(function(e){t.append(createRestaurantHTML(e))}),addMarkersToMap()},createRestaurantHTML=function(e){var t=document.createElement("li"),n="Image of restaurant name "+e.name+", located nearby "+e.neighborhood+", address "+e.address,r=document.createElement("img"),o=DBHelper.imageUrlForRestaurant(e);r.className="restaurant-img",r.src="/build/img/"+o+".webp",r.srcset="/build/img/"+o+".webp 1x, /build/img/"+o+".jpg 2x",r.alt=n,r.tabIndex=0,t.append(r);var a=document.createElement("h2");a.innerHTML=e.name,a.setAttribute("aria-label",e.name),t.append(a);var i=document.createElement("p");i.innerHTML=e.neighborhood,t.append(i);var s=document.createElement("p");s.innerHTML=e.address,t.append(s);var c=document.createElement("a");return c.innerHTML="View Details",c.href=DBHelper.urlForRestaurant(e),c.setAttribute("role","button"),c.setAttribute("aria-label","View Details"),c.setAttribute("aria-pressed","false"),t.append(c),t},addMarkersToMap=function(){(0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurants).forEach(function(e){var t=DBHelper.mapMarkerForRestaurant(e,self.newMap);t.on("click",function(){window.location.href=t.options.url}),self.markers.push(t)})},handleBtnClick=function(e){toggleButton(e.target)},handleBtnKeyPress=function(e){" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),toggleButton(e.target))},toggleButton=function(e){var t="true"===e.getAttribute("aria-pressed");e.setAttribute("aria-pressed",!t)},isOnline=function(e){var t=void 0;"offline"==e.type&&(console.log("You lost connection."),t="You lost connection."),"online"==e.type&&(console.log("You are now online."),t="You are now online.",DBHelper.syncOutBoxData().then(function(e){var t;0<e.length&&e.forEach((t=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.info("Syncing OutBox Data: "+JSON.stringify(t)),n=t.createdAt,r=void 0,e.next=5,DBHelper.addReview(t);case 5:return r=e.sent,console.info("Uploaded pending request "+JSON.stringify(r)),e.next=9,DBHelper.clearOutBoxData(n);case 9:r=e.sent,console.info("Removed data from Outbox: "+r);case 11:case"end":return e.stop()}},e,void 0)})),function(e){return t.apply(this,arguments)}))}).catch(function(e){console.error("outBoxData",e.stack)})),Snackbar.show({text:t,actionText:"OK",actionTextColor:"#f44336",textColor:"#fff",pos:"bottom-center"})};window.addEventListener("online",isOnline),window.addEventListener("offline",isOnline);</script>
  <script>"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,n){"function"==typeof define&&define.amd?define([],function(){return t.Snackbar=n()}):"object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports?module.exports=t.Snackbar=n():t.Snackbar=n()}(void 0,function(){var r={current:null},a={text:"Default Text",textColor:"#FFFFFF",width:"auto",showAction:!0,actionText:"Dismiss",actionTextColor:"#4CAF50",showSecondButton:!1,secondButtonText:"",secondButtonTextColor:"#4CAF50",backgroundColor:"#323232",pos:"bottom-left",duration:5e3,customClass:"",onActionClick:function(t){t.style.opacity=0},onSecondButtonClick:function(t){},onClose:function(t){}};r.show=function(t){var o=i(!0,a,t);r.current&&(r.current.style.opacity=0,setTimeout(function(){var t=this.parentElement;t&&t.removeChild(this)}.bind(r.current),500)),r.snackbar=document.createElement("div"),r.snackbar.className="snackbar-container "+o.customClass,r.snackbar.style.width=o.width;var n=document.createElement("p");if(n.style.margin=0,n.style.padding=0,n.style.color=o.textColor,n.style.fontSize="14px",n.style.fontWeight=300,n.style.lineHeight="1em",n.innerHTML=o.text,r.snackbar.appendChild(n),r.snackbar.style.background=o.backgroundColor,o.showSecondButton){var e=document.createElement("button");e.className="action",e.innerHTML=o.secondButtonText,e.style.color=o.secondButtonTextColor,e.addEventListener("click",function(){o.onSecondButtonClick(r.snackbar)}),r.snackbar.appendChild(e)}if(o.showAction){var c=document.createElement("button");c.className="action",c.innerHTML=o.actionText,c.style.color=o.actionTextColor,c.addEventListener("click",function(){o.onActionClick(r.snackbar)}),r.snackbar.appendChild(c)}o.duration&&setTimeout(function(){r.current===this&&(r.current.style.opacity=0,r.current.style.top="-100px",r.current.style.bottom="-100px")}.bind(r.snackbar),o.duration),r.snackbar.addEventListener("transitionend",function(t,n){"opacity"===t.propertyName&&"0"===this.style.opacity&&("function"==typeof o.onClose&&o.onClose(this),this.parentElement.removeChild(this),r.current===this&&(r.current=null))}.bind(r.snackbar)),r.current=r.snackbar,document.body.appendChild(r.snackbar),getComputedStyle(r.snackbar).bottom,getComputedStyle(r.snackbar).top,r.snackbar.style.opacity=1,r.snackbar.className="snackbar-container "+o.customClass+" snackbar-pos "+o.pos},r.close=function(){r.current&&(r.current.style.opacity=0)};var i=function o(){var e={},c=!1,t=0,n=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(c=arguments[0],t++);for(var r=function(t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(c&&"[object Object]"===Object.prototype.toString.call(t[n])?e[n]=o(!0,e[n],t[n]):e[n]=t[n])};t<n;t++)r(arguments[t]);return e};return r});</script>
</body>

</html>